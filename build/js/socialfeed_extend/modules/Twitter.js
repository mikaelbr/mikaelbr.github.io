define(["socialfeed","handlebars","text!tmpl/Twitter.html","text!tmpl/TwitterRetweet.html"],function(e,t,n,r){function o(e){return $("<div/>").text(e).html()}function u(e){if(!e.entities)return o(e.text);var t={};$.each(e.entities.urls,function(e,n){t[n.indices[0]]=[n.indices[1],function(e){return"<a href='"+o(n.url)+"'>"+o(n.display_url)+"</a>"}]}),$.each(e.entities.hashtags,function(e,n){t[n.indices[0]]=[n.indices[1],function(e){return"<a href='http://twitter.com/search?q="+escape("#"+n.text)+"'>"+o(e)+"</a>"}]}),$.each(e.entities.user_mentions,function(e,n){t[n.indices[0]]=[n.indices[1],function(e){return"<a title='"+o(n.name)+"' href='http://twitter.com/"+o(n.screen_name)+"'>"+o(e)+"</a>"}]});var n="",r=0,i=0;for(i=0;i<e.text.length;++i){var s=t[i];if(s){var u=s[0],a=s[1];i>r&&(n+=o(e.text.substring(r,i))),n+=a(e.text.substring(i,u)),i=u-1,r=u}}return i>r&&(n+=o(e.text.substring(r,i))),n}var i=t.compile(n),s=t.compile(r);return t.registerHelper("twitParse",function(e){return new t.SafeString(u(e))}),e.Modules.extend({url:function(){return"http://mib-twitfeed.herokuapp.com/?count="+(this.ident||10)},orderBy:function(e){return-(new Date(e.created_at)).getTime()},render:function(e){return e.retweeted_status?s(e):i(e)}})});